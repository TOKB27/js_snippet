<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bootstrap 管理画面</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container py-4">

  <!-- Header -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="h4 m-0">トップ画面</h1>

    <div class="d-flex gap-2">
      <select class="form-select form-select-sm w-auto" id="statusFilter">
        <option value="">すべて</option>
        <option value="有効">有効</option>
        <option value="停止">停止</option>
      </select>
      <button class="btn btn-primary btn-sm">新規作成</button>
    </div>
  </div>

  <!-- Table -->
  <div class="card shadow-sm">
    <div class="card-body">
      <table class="table table-hover align-middle mb-0">
        <thead class="table-light">
          <tr>
            <th style="width:90px">操作</th>
            <th>ID</th>
            <th>名前</th>
            <th>状態</th>
            <th>更新日</th>
          </tr>
        </thead>
        <tbody id="mainTbody">
          <tr data-status="有効">
            <td>
              <button
                class="btn btn-outline-primary btn-sm js-open-modal"
                data-bs-toggle="modal"
                data-bs-target="#detailModal"
                data-id="101"
                data-name="田中 太郎"
                data-status="有効"
                data-updated="2025-12-17"
              >詳細</button>
            </td>
            <td>101</td>
            <td>田中 太郎</td>
            <td><span class="badge text-bg-success">有効</span></td>
            <td>2025-12-17</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="detailModal" tabindex="-1">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">

      <!-- Modal header -->
      <div class="modal-header d-flex justify-content-between align-items-center">
        <h5 class="modal-title">詳細</h5>

        <!-- Mode switch -->
        <div class="btn-group btn-group-sm" role="group">
          <button type="button" class="btn btn-outline-secondary active" id="viewModeBtn">
            閲覧
          </button>
          <button type="button" class="btn btn-outline-secondary" id="editModeBtn">
            編集
          </button>
        </div>
      </div>

      <!-- Modal body -->
      <div class="modal-body">
        <form id="detailForm">

          <!-- ID -->
          <div class="row mb-3">
            <label class="col-sm-3 col-form-label">ID</label>
            <div class="col-sm-9">
              <p class="form-control-plaintext view-mode" id="viewId"></p>
              <input
              class="form-control edit-mode d-none bg-light text-muted"
              id="editId"
              readonly
              tabindex="-1"
              />
            </div>
          </div>

          <!-- 名前 -->
          <div class="row mb-3">
            <label class="col-sm-3 col-form-label">名前</label>
            <div class="col-sm-9">
              <p class="form-control-plaintext view-mode" id="viewName"></p>
              <input class="form-control edit-mode d-none" id="editName">
            </div>
          </div>

          <!-- 状態 -->
          <div class="row mb-3">
            <label class="col-sm-3 col-form-label">状態</label>
            <div class="col-sm-9">
              <p class="form-control-plaintext view-mode" id="viewStatus"></p>
              <select class="form-select edit-mode d-none" id="editStatus">
                <option value="有効">有効</option>
                <option value="停止">停止</option>
              </select>
            </div>
          </div>

          <!-- 更新日 -->
          <div class="row">
            <label class="col-sm-3 col-form-label">更新日</label>
            <div class="col-sm-9">
              <p class="form-control-plaintext view-mode" id="viewUpdated"></p>
              <input type="date" class="form-control edit-mode d-none" id="editUpdated">
            </div>
          </div>

        </form>
      </div>

      <!-- Modal footer -->
      <div class="modal-footer">
        <button class="btn btn-outline-secondary" data-bs-dismiss="modal">閉じる</button>
        <button class="btn btn-success edit-mode d-none" form="detailForm">保存</button>
      </div>

    </div>
  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
  // ===== モード切替 =====
  const viewBtn = document.getElementById("viewModeBtn");
  const editBtn = document.getElementById("editModeBtn");

  function switchToView() {
    document.querySelectorAll(".edit-mode").forEach(e => e.classList.add("d-none"));
    document.querySelectorAll(".view-mode").forEach(e => e.classList.remove("d-none"));
    viewBtn.classList.add("active");
    editBtn.classList.remove("active");
  }

  function switchToEdit() {
    document.querySelectorAll(".view-mode").forEach(e => e.classList.add("d-none"));
    document.querySelectorAll(".edit-mode").forEach(e => e.classList.remove("d-none"));
    editBtn.classList.add("active");
    viewBtn.classList.remove("active");
  }

  viewBtn.addEventListener("click", switchToView);
  editBtn.addEventListener("click", switchToEdit);

  document.getElementById("detailModal").addEventListener("hidden.bs.modal", switchToView);

  // ===== モーダルに値を流し込む =====
  document.addEventListener("click", e => {
    const btn = e.target.closest(".js-open-modal");
    if (!btn) return;

    viewId.textContent = btn.dataset.id;
    viewName.textContent = btn.dataset.name;
    viewStatus.textContent = btn.dataset.status;
    viewUpdated.textContent = btn.dataset.updated;

    editId.value = btn.dataset.id;
    editName.value = btn.dataset.name;
    editStatus.value = btn.dataset.status;
    editUpdated.value = btn.dataset.updated;

    switchToView();
  });

  // ===== 保存（デモ） =====
  document.getElementById("detailForm").addEventListener("submit", e => {
    e.preventDefault();
    switchToView();
  });
</script>

</body>
</html>
